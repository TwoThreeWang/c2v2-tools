{{ define "json_fmt_result.html" }}
<div class="relative w-full h-full flex flex-col">
    {{ if .isError }}
        <div class="w-full h-full p-4 text-red-600 font-mono text-sm bg-red-50 border border-red-200 rounded-lg overflow-auto">
            <div class="whitespace-pre-wrap break-words">
                {{ .result }}
            </div>
        </div>
    {{ else }}
        <div class="relative w-full h-full flex flex-col">
            <label for="output-json" class="sr-only">Formatted JSON</label>
            
            <!-- Line Numbers Output -->
            <div class="flex flex-grow w-full overflow-auto">
                <!-- Line Numbers -->
                <div class="flex flex-col bg-slate-100 border-r border-slate-200 select-none" style="min-width: 3rem;">
                    <div id="output-line-numbers" class="px-2 py-4 text-right text-xs text-slate-500 font-mono leading-6">
                        <!-- Line numbers will be populated by JavaScript -->
                    </div>
                </div>
                <!-- Syntax Highlighted Output -->
                <div class="flex-1 overflow-auto">
                    <pre id="output-content" class="w-full h-full p-4 bg-slate-50 font-mono text-sm text-slate-700"><code class="language-json">{{ .result }}</code></pre>
                </div>
            </div>
        
        <!-- Hidden textarea for copy functionality -->
        <textarea id="output-json" class="hidden">{{ .result }}</textarea>
        
        <!-- Stats Bar -->
        <div class="absolute bottom-2 right-2 px-2 py-1 bg-slate-100/80 backdrop-blur rounded text-[10px] text-slate-500 font-mono pointer-events-none">
            {{ .charCount }} {{ call .T "stats_chars" }} | {{ .byteCount }} {{ call .T "stats_bytes" }}
        </div>

        <!-- Copy Button Overlay -->
        <button 
            type="button"
            onclick="navigator.clipboard.writeText(document.getElementById('output-json').value).then(() => { this.innerHTML = '<span class=\'text-green-600\'>Copied!</span>'; setTimeout(() => this.innerText = 'Copy', 2000) })"
            class="absolute top-2 right-2 px-3 py-1 bg-white border border-slate-200 rounded text-xs font-semibold text-slate-600 shadow-sm hover:border-indigo-500 hover:text-indigo-600 transition-all z-10"
        >
            Copy
        </button>
        </div>
    {{ end }}
</div>
{{ end }}
